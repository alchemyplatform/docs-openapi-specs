openapi: 3.1.0
info:
  # readme reflects this as category name
  title: bastien test
  version: '1.0'
servers:
  - url: 'https://eth-mainnet.g.alchemy.com/v2'
    description: Ethereum
paths:
  /{apiKey}:
    post:
      # if omitted, readme uses method as title
      summary: alchemy_simulateAssetChanges
      # if omitted, readme uses method_path as url (e.g. /reference/post_apikey)
      operationId: alchemy-simulateAssetChanges
      parameters:
        - $ref: '#/components/parameters/ParamApiKey'
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                id:
                  type: integer
                  default: 1
                jsonrpc:
                  type: string
                  default: '2.0'
                method:
                  type: string
                  default: alchemy_simulateAssetChanges
                params:
                  type: array
                  # TODO: are minItems and maxItems in the spec? or readme extensions?
                  # does minItems work - readme allows me to delete all params
                  minItems: 1
                  # maxItems works!
                  maxItems: 1
                  items:
                    type: object
                    properties:
                      # required - TODO: are from, value, and data required?
                      from:
                        $ref: '#/components/schemas/Address'
                        # override default address
                        default: '0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045'
                      to:
                        $ref: '#/components/schemas/Address'
                        default: '0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48'
                      value:
                        $ref: '#/components/schemas/Hex'
                        default: '0x0'
                      data:
                        $ref: '#/components/schemas/Hex'
                        default: '0xa9059cbb000000000000000000000000fc43f5f9dd45258b3aff31bdbe6561d97e8b71de00000000000000000000000000000000000000000000000000000000000f4240'
                      
                      # optional
                      gas:
                        type: string
                      gasPrice:
                        type: string
                      maxFeePerGas:
                        type: string
                      maxPriorityFeePerGas:
                        type: string

                    required:
                      - to
                  # TODO: add blocktag as 2nd param
      responses:
        '200':
          description: OK

components:
  schemas:
    Hex:
      type: string
      pattern: '^0[xX][0-9a-fA-F]+$'
    
    # TODO: this does not allow for ENS addresses (e.g. vitalik.eth)
    Address:
      allOf:
        - $ref: '#/components/schemas/Hex'
        - minLength: 42
        - maxLength: 42
        # vitalik.eth ETH address
        - default: '0xd8da6bf26964af9d7eed9e03e53415d37aa96045'

  parameters:
    ParamApiKey:
      name: apiKey
      in: path
      description: For higher throughput, **[create your own API key](https://alchemy.com/?a=docs-demo)**.
      required: true
      schema:
        type: string
        default: docs-demo